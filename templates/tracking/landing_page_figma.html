{% extends 'base.html' %}
{% load static %}

{% block title %}Welcome to Meridian Asset Logistics - Redesigned{% endblock %}

{% block extra_head %}
<!-- Figma Design System CSS -->
<link rel="stylesheet" href="{% static 'figma/css/global.css' %}">

<!-- Custom Figma Landing Page Styles -->
<style>
    /* Additional custom styles for the Figma landing page */
    .figma-landing {
        @apply min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800;
    }
    
    /* Smooth scrolling */
    html {
        scroll-behavior: smooth;
    }
    
    /* Custom animations */
    @keyframes fade-in-up {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes fade-in-left {
        from {
            opacity: 0;
            transform: translateX(-30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    @keyframes fade-in-right {
        from {
            opacity: 0;
            transform: translateX(30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    .animate-fade-in-up {
        animation: fade-in-up 0.6s ease-out;
    }
    
    .animate-fade-in-left {
        animation: fade-in-left 0.6s ease-out;
    }
    
    .animate-fade-in-right {
        animation: fade-in-right 0.6s ease-out;
    }
    
    .animate-fade-in {
        animation: fade-in 0.6s ease-out;
    }
    
    @keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    /* Investment section with financial chart background */
    .investment-opportunities-section {
        @apply relative py-16 overflow-hidden;
        background-image: url('https://static.vecteezy.com/system/resources/previews/025/500/837/non_2x/financial-chart-on-dark-background-represent-stock-market-analysis-or-investment-concept-financial-graphs-glowing-lines-and-diagrams-on-digital-screen-ai-generated-free-photo.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
    }
    
    .investment-opportunities-section::before {
        content: '';
        @apply absolute inset-0 bg-gradient-to-br from-black/90 via-slate-900/90 to-black/90;
    }
    
    .investment-opportunities-section::after {
        content: '';
        @apply absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-black/50;
    }
    
    /* CTA section with container ship background */
    .cta-section {
        @apply relative py-16 overflow-hidden;
        background-image: url('https://static.vecteezy.com/system/resources/previews/029/851/888/large_2x/container-ship-with-open-sea-and-sea-in-the-background-created-with-ai-free-photo.jpeg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
    }
    
    .cta-section::before {
        content: '';
        @apply absolute inset-0 bg-gradient-to-br from-black/70 via-blue-900/80 to-black/70;
    }
    
    .cta-section::after {
        content: '';
        @apply absolute inset-0 bg-blue-600/60;
    }
    
    /* Investment cards with background images */
    .investment-card {
        @apply relative rounded-2xl overflow-hidden min-h-80;
        @apply transition-all duration-300 hover:scale-105 hover:shadow-2xl;
    }
    
    .precious-metals-card {
        background-image: url('https://tse4.mm.bing.net/th/id/OIP.FQbGsoIH33gsg8iUTNcXtwHaFj?rs=1&pid=ImgDetMain&o=7&rm=3');
        background-size: cover;
        background-position: center;
    }
    
    .real-estate-card {
        background-image: url('https://api.oneworld.id/uploads/Real_Estate_i_Stock_edited_aae30f2583.jpg');
        background-size: cover;
        background-position: center;
    }
    
    .diamonds-gems-card {
        background-image: url('https://watchandwares.com/wp-content/uploads/2019/08/iStock-147992985.jpg');
        background-size: cover;
        background-position: center;
    }
    
    .investment-card::before {
        content: '';
        @apply absolute inset-0 bg-gradient-to-br from-black/80 via-slate-900/85 to-black/80;
    }
    
    .investment-card::after {
        content: '';
        @apply absolute inset-0 bg-slate-900/60;
    }
    
    /* Enhanced text shadows for readability */
    .investment-card h3 {
        text-shadow: 3px 3px 8px rgba(0, 0, 0, 0.9), 0 0 16px rgba(0, 0, 0, 0.8);
        @apply font-black text-white;
    }
    
    .investment-card p {
        text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.9), 0 0 12px rgba(0, 0, 0, 0.8);
        @apply font-semibold text-slate-200;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .investment-opportunities-section,
        .cta-section {
            background-attachment: scroll;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="figma-landing">
    <!-- Welcome Message for Authenticated Customers -->
    {% if user.is_authenticated and not user.is_staff %}
    <div class="bg-blue-600 text-white py-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-2xl font-bold">Welcome, {{ user.get_full_name|default:user.username }}!</h2>
                <p class="mt-1 text-blue-100">Access your investment dashboard and portfolio</p>
                <div class="mt-3 space-x-4">
                    <a href="{% url 'investments:investment-dashboard' %}" class="btn btn-primary">
                        <i class="fas fa-chart-line mr-2"></i>Investment Dashboard
                    </a>
                    <a href="{% url 'investments:user-portfolio' %}" class="btn btn-outline">
                        <i class="fas fa-briefcase mr-2"></i>My Portfolio
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Hero Section -->
    <section class="hero-section" id="hero">
        <div class="hero-background">
            <div class="hero-overlay"></div>
        </div>
        
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-badge">
                    <span class="hero-badge-text">âœ¨ New Features Available</span>
                </div>
                
                <h1 class="hero-title">
                    <span class="hero-title-main">Track Your Package</span>
                    <span class="hero-title-accent">with Confidence</span>
                </h1>
                
                <p class="hero-description">
                    Experience seamless tracking with our advanced monitoring system. 
                    Simply enter your tracking number and watch your package journey 
                    across the globe in real-time.
                </p>
                
                <div class="hero-actions">
                    <button class="btn btn-primary hero-btn-primary" data-size="lg" onclick="scrollToTracking()">
                        <i class="fas fa-search mr-2"></i>
                        Track Package
                    </button>
                    <button class="btn btn-outline hero-btn-secondary" data-size="lg" onclick="scrollToHelp()">
                        <i class="fas fa-question-circle mr-2"></i>
                        Need Help?
                    </button>
                </div>
                
                <div class="hero-stats">
                    <div class="hero-stat">
                        <div class="hero-stat-number">1M+</div>
                        <div class="hero-stat-label">Packages Tracked</div>
                    </div>
                    <div class="hero-stat">
                        <div class="hero-stat-number">99.9%</div>
                        <div class="hero-stat-label">Success Rate</div>
                    </div>
                    <div class="hero-stat">
                        <div class="hero-stat-number">24/7</div>
                        <div class="hero-stat-label">Support</div>
                    </div>
                </div>
            </div>
            
            <div class="hero-visual">
                <div class="hero-image-container">
                    <img 
                        src="https://ilovemoving.com/wp-content/uploads/2021/08/blog-header.jpg" 
                        alt="Container Ship - Global Logistics Transportation"
                        class="hero-image"
                        onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80';"
                    />
                    <div class="hero-image-overlay"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tracking Section -->
    <section id="tracking-section" class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:text-center">
                <h2 class="text-base text-blue-600 font-semibold tracking-wide uppercase">Tracking</h2>
                <p class="mt-2 text-3xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl">
                    Where's My Package?
                </p>
                <p class="mt-4 max-w-2xl text-xl text-gray-500 lg:mx-auto">
                    Enter your tracking number below to get real-time updates on your shipment.
                </p>
            </div>

            <div class="mt-10 max-w-xl mx-auto">
                <div class="card">
                    <div class="card-content">
                        <form id="tracking-form" class="space-y-4">
                            <div class="input-container">
                                <label for="tracking-number" class="input-label">Tracking Number</label>
                                <div class="input-wrapper">
                                    <input 
                                        type="text" 
                                        id="tracking-number" 
                                        name="tracking_number" 
                                        class="input" 
                                        placeholder="Enter your tracking number"
                                        required
                                    />
                                </div>
                            </div>
                            <button type="submit" id="track-button" class="btn btn-primary w-full">
                                <i class="fas fa-search mr-2"></i>
                                <span id="track-button-text">Track Package</span>
                            </button>
                        </form>
                        
                        <!-- Loading and Error Messages -->
                        <div id="tracking-message" class="mt-4 hidden">
                            <div id="tracking-success" class="hidden bg-green-50 border border-green-200 rounded-md p-3">
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span id="success-text" class="text-sm text-green-800"></span>
                                </div>
                            </div>
                            <div id="tracking-error" class="hidden bg-red-50 border border-red-200 rounded-md p-3">
                                <div class="flex items-center">
                                    <i class="fas fa-exclamation-triangle text-red-400 mr-2"></i>
                                    <span id="error-text" class="text-sm text-red-800"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section" id="features">
        <div class="features-container">
            <div class="features-header">
                <div class="features-badge">
                    <span class="features-badge-text">âœ¨ Features</span>
                </div>
                
                <h2 class="features-title">
                    Why Choose <span class="features-title-accent">Meridian Asset Logistics</span>?
                </h2>
                
                <p class="features-description">
                    Experience excellence with our world-class logistics services, 
                    real-time tracking, and exceptional customer support.
                </p>
            </div>
            
            <div class="features-grid">
                <!-- Real-time Tracking Feature -->
                <div class="feature-card" data-feature="tracking">
                    <div class="feature-icon-container">
                        <div class="feature-icon-bg tracking-bg">
                            <i class="fas fa-shipping-fast feature-icon"></i>
                            <div class="feature-icon-pulse tracking-pulse"></div>
                        </div>
                    </div>
                    
                    <div class="feature-content">
                        <h3 class="feature-title">
                            <span class="text-cyan-400">Real-time</span> <span class="text-white">Tracking</span>
                        </h3>
                        <p class="feature-description">
                            <span class="text-yellow-400 font-semibold">Get instant updates</span> on your package location and 
                            <span class="text-emerald-400 font-semibold">delivery status</span> with our advanced tracking system.
                        </p>
                    </div>
                </div>
                
                <!-- Secure & Private Feature -->
                <div class="feature-card" data-feature="security">
                    <div class="feature-icon-container">
                        <div class="feature-icon-bg security-bg">
                            <i class="fas fa-shield-alt feature-icon"></i>
                            <div class="feature-icon-pulse security-pulse"></div>
                        </div>
                    </div>
                    
                    <div class="feature-content">
                        <h3 class="feature-title">
                            <span class="text-emerald-400">Secure</span> <span class="text-white">&</span> <span class="text-cyan-400">Private</span>
                        </h3>
                        <p class="feature-description">
                            <span class="text-pink-400 font-semibold">Your tracking information</span> is secure and 
                            <span class="text-yellow-400 font-semibold">only accessible to you</span> with bank-level encryption.
                        </p>
                    </div>
                </div>
                
                <!-- 24/7 Support Feature -->
                <div class="feature-card" data-feature="support">
                    <div class="feature-icon-container">
                        <div class="feature-icon-bg support-bg">
                            <i class="fas fa-headset feature-icon"></i>
                            <div class="feature-icon-pulse support-pulse"></div>
                        </div>
                    </div>
                    
                    <div class="feature-content">
                        <h3 class="feature-title">
                            <span class="text-orange-400">24/7</span> <span class="text-white">Support</span>
                        </h3>
                        <p class="feature-description">
                            <span class="text-cyan-400 font-semibold">Our customer care team</span> is always here to help you 
                            <span class="text-emerald-400 font-semibold">whenever you need us</span>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Investment Opportunities Section -->
    <section class="investment-opportunities-section">
        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <div class="bg-black/50 backdrop-blur-sm rounded-2xl p-8 mx-4">
                    <h2 class="text-3xl font-extrabold text-white sm:text-4xl mb-6">
                        <span class="inline-block animate-bounce">ðŸ’Ž</span>
                        Investment Opportunities
                        <span class="inline-block animate-bounce" style="animation-delay: 0.5s;">ðŸš€</span>
                    </h2>
                    <p class="text-xl text-white max-w-4xl mx-auto mb-8">
                        <span class="text-yellow-300 font-bold animate-pulse">âœ¨ Transform your wealth</span> with 
                        <span class="text-emerald-300 font-semibold">precious metals</span>, 
                        <span class="text-pink-300 font-semibold">diamonds</span>, 
                        <span class="text-cyan-300 font-semibold">real estate</span>, and 
                        <span class="text-purple-300 font-semibold">cryptocurrency</span>. 
                        <span class="text-orange-300 font-bold">Build your legacy</span> with 
                        <span class="text-yellow-400 font-extrabold">strategic investments</span> and 
                        <span class="text-cyan-400 font-bold">expert guidance</span>!
                    </p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-12">
                    <!-- Precious Metals Card -->
                    <div class="investment-card precious-metals-card">
                        <div class="relative z-10 text-center p-8">
                            <div class="mb-6">
                                <i class="fas fa-coins text-4xl text-emerald-400 mb-4"></i>
                            </div>
                            <h3 class="text-2xl font-bold mb-4">
                                <span class="text-emerald-400">Precious</span> <span class="text-white">Metals</span>
                            </h3>
                            <p class="text-slate-200">
                                <span class="text-yellow-400 font-semibold">Gold, silver, and platinum</span> investments with 
                                <span class="text-cyan-400 font-semibold">real-time tracking</span> and 
                                <span class="text-emerald-400 font-semibold">secure storage</span>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Real Estate Card -->
                    <div class="investment-card real-estate-card">
                        <div class="relative z-10 text-center p-8">
                            <div class="mb-6">
                                <i class="fas fa-building text-4xl text-blue-400 mb-4"></i>
                            </div>
                            <h3 class="text-2xl font-bold mb-4">
                                <span class="text-blue-400">Real</span> <span class="text-white">Estate</span>
                            </h3>
                            <p class="text-slate-200">
                                <span class="text-cyan-400 font-semibold">Property investments</span> with 
                                <span class="text-yellow-400 font-semibold">growth potential</span>, 
                                <span class="text-emerald-400 font-semibold">rental income</span>, and 
                                <span class="text-pink-400 font-semibold">portfolio diversification</span>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Diamonds & Gems Card -->
                    <div class="investment-card diamonds-gems-card">
                        <div class="relative z-10 text-center p-8">
                            <div class="mb-6">
                                <i class="fas fa-gem text-4xl text-purple-400 mb-4"></i>
                            </div>
                            <h3 class="text-2xl font-bold mb-4">
                                <span class="text-purple-400">Diamonds</span> <span class="text-white">&</span> <span class="text-pink-400">Gems</span>
                            </h3>
                            <p class="text-slate-200">
                                <span class="text-yellow-400 font-semibold">Rare and valuable stones</span> with 
                                <span class="text-cyan-400 font-semibold">certified authenticity</span> and 
                                <span class="text-purple-400 font-semibold">investment-grade quality</span>
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-12 text-center">
                    {% if user.is_authenticated and not user.is_staff %}
                        <a href="{% url 'investments:investment-dashboard' %}" class="btn btn-primary btn-lg mr-4">
                            <i class="fas fa-chart-line mr-2"></i>Investment Dashboard
                        </a>
                        <a href="{% url 'investments:user-portfolio' %}" class="btn btn-outline btn-lg">
                            <i class="fas fa-briefcase mr-2"></i>My Portfolio
                        </a>
                    {% else %}
                        <a href="{% url 'investments:investment-marketplace' %}" class="btn btn-primary btn-lg mr-4">
                            <i class="fas fa-store mr-2"></i>Investment Marketplace
                        </a>
                        <a href="{% url 'accounts:customer_register' %}" class="btn btn-outline btn-lg">
                            <i class="fas fa-user-plus mr-2"></i>Get Started
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="relative z-10 max-w-2xl mx-auto text-center py-16 px-4 sm:py-20 sm:px-6 lg:px-8">
            <div class="bg-black/30 rounded-lg mx-4 p-8">
                <h2 class="text-3xl font-extrabold text-white sm:text-4xl mb-4">
                    <span class="block">Ready to ship?</span>
                    <span class="block">Contact us today.</span>
                </h2>
                <p class="text-lg leading-6 text-white mb-8">
                    Let us handle your logistics needs with our professional shipping services.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="{% url 'frontend:calculate_cost' %}" class="btn btn-primary">
                        Calculate Cost
                    </a>
                    <a href="{% url 'frontend:tracking_status_guide' %}" class="btn btn-outline">
                        Learn More
                    </a>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Include Figma Components -->
<script src="{% static 'figma/js/utils.js' %}"></script>

<script>
// Tracking form functionality
document.getElementById('tracking-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const trackingNumber = document.getElementById('tracking-number').value.trim();
    const trackButton = document.getElementById('track-button');
    const trackButtonText = document.getElementById('track-button-text');
    const trackingMessage = document.getElementById('tracking-message');
    const trackingSuccess = document.getElementById('tracking-success');
    const trackingError = document.getElementById('tracking-error');
    const successText = document.getElementById('success-text');
    const errorText = document.getElementById('error-text');
    
    if (!trackingNumber) {
        showError('Please enter a tracking number');
        return;
    }
    
    // Show loading state
    trackButton.disabled = true;
    trackButtonText.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Searching...';
    hideMessages();
    
    try {
        const response = await fetch('{% url "frontend:search_tracking" %}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                tracking_number: trackingNumber
            })
        });
        
        const data = await response.json();
        
        if (response.ok && data.success) {
            showSuccess(`Tracking found! Redirecting to tracking page...`);
            setTimeout(() => {
                window.location.href = data.tracking_url;
            }, 1500);
        } else {
            showError(data.error || 'An error occurred while searching for your tracking number.');
        }
    } catch (error) {
        console.error('Error:', error);
        showError('An error occurred while searching for your tracking number. Please try again.');
    } finally {
        trackButton.disabled = false;
        trackButtonText.innerHTML = '<i class="fas fa-search mr-2"></i>Track Package';
    }
});

function showSuccess(message) {
    const trackingMessage = document.getElementById('tracking-message');
    const trackingSuccess = document.getElementById('tracking-success');
    const successText = document.getElementById('success-text');
    
    successText.textContent = message;
    trackingMessage.classList.remove('hidden');
    trackingSuccess.classList.remove('hidden');
    document.getElementById('tracking-error').classList.add('hidden');
}

function showError(message) {
    const trackingMessage = document.getElementById('tracking-message');
    const trackingError = document.getElementById('tracking-error');
    const errorText = document.getElementById('error-text');
    
    errorText.textContent = message;
    trackingMessage.classList.remove('hidden');
    trackingError.classList.remove('hidden');
    document.getElementById('tracking-success').classList.add('hidden');
}

function hideMessages() {
    document.getElementById('tracking-message').classList.add('hidden');
    document.getElementById('tracking-success').classList.add('hidden');
    document.getElementById('tracking-error').classList.add('hidden');
}

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// Scroll functions
function scrollToTracking() {
    document.getElementById('tracking-section').scrollIntoView({ behavior: 'smooth' });
}

function scrollToHelp() {
    const helpSection = document.querySelector('#help-section');
    if (helpSection) {
        helpSection.scrollIntoView({ behavior: 'smooth' });
    } else {
        // Fallback to contact or support section
        const contactSection = document.querySelector('#contact-section');
        if (contactSection) {
            contactSection.scrollIntoView({ behavior: 'smooth' });
        }
    }
}

// Enhanced image loading with fallbacks
document.addEventListener('DOMContentLoaded', function() {
    // Hero image loading
    const heroImage = document.querySelector('.hero-image');
    if (heroImage) {
        const fallbackImages = [
            'https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80',
            'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80',
            'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80'
        ];
        
        let currentIndex = 0;
        
        heroImage.onerror = function() {
            if (currentIndex < fallbackImages.length) {
                this.src = fallbackImages[currentIndex];
                currentIndex++;
            }
        };
    }
    
    // Initialize Figma components
    if (window.FigmaUtils) {
        // Add any additional initialization here
        console.log('Figma design system loaded successfully');
    }
});
</script>
{% endblock %}
